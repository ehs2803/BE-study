# JVM의 메모리 구조

응용프로그램이 실행되면, JVM은 시스템으로부터 프로그램을 수행하는데 필요한 메모리를 할당받고 JVM은 이 메모리를 용도에 따라 여러 영역으로 나누어 관리한다.

그 중 method area, call stack, heap이 중요하다.

1. 메서드 영역(method area)<br>
프로그램 실행 중 어떤 클래스가 사용되면 JVM은 해당 클래스의 클래스파일을 읽어서 분석하여 클래스에 대한 정보(클래스 데이터)를 이곳에 저장한다. 이때, 그 클래스의 클래스변수도 이 영역에 함께 생성한다.

2. 힙(heap)<br>
인스턴스가 생성되는 공간으로 프로그램 실행 중 생성되는 인스턴스는 모두 이곳에 생성된다. 즉 인스턴스 변수들이 생성되는 공간이다.

3. 호출스택(call stack or execution stack)<br>
호출스택은 메서드의 작업에 필요한 메모리 공간을 제공한다. 메서드가 호출되면, 호출스택에 호출된 메서드를 위한 메모리가 할당되며, 이 메모리는 메서드가 작업을 수행하는 동안 지역변수(매개변수 포함)
들과 연산의 중간결과 등을 저장하는데 사용된다. 그리고 메서드가 작업을 마치면 할당되었던 메모리공간은 반환되어 비워진다.
각 메서드를 위한 메모리상의 작업공간은 서로 구별되며, 첫번째로 호출된 메서드를 위한 작업공간이 호출스택의 맨 밑에 마련되고, 첫번쩨 메서드 수행 중에 다른 메서드를 호출하면, 첫번째 메서드의 
바로 위에 두번째로 호출된 메서드를 위한 공간이 마련된다.

- 메서드가 호출되면 수행에 필요한 만큼의 메모리를 스택에 할당받는다.
- 메서드가 수행을 마치고나면 사용했던 메모리를 반환하고 스택에서 제거
- 호출스택의 제일 위에 있는 메서드가 현재 실행 중인 메서드
- 아래에 있는 메서드가 바로 위에 메서드를 호출한 메서드이다.

# 클래스와 객체

1. 변수 : 하나의 데이터를 저장할 수 있는 공간
2. 배열 : 같은 종류의 여러 데이터를 하나의 집합으로 저장할 수 있는 공간
3. 구조체 : 서로 관련된 여러 데이트를 종류에 관계없이 하나의 집합으로 저장할 수 있는 공간
4. 클래스 : 데이터와 함수의 결합(구조체+함수)


클래스 : 객체를 정의해 놓은 것으로 객체를 생성하는데 사용된다.

객체 : 실제로 존재하는 것, 사물 또는 개념으로 객체가 가지고 있는 기능과 속성에 따라 다르다.

# 객체와 인스턴스

클래스로부터 객체를 만드는 과정을 클래스의 인스턴화라고 한다.
어떤 클래스로부터 만들어진 객체를 그 클래스의 인스턴스라고 한다.

# 객체의 구성요소

속성(property) : 멤버변수, 특성, 필드, 상태

기능(function) : 메서드, 함수, 행위

# 인스턴스의 생성과 사용

```java
클래스명 변수명;
변수명 = new 클래스명();

Tv t;
t = new Tv();

class Tv { 
     // Tv의 속성(멤버변수) 
     String color;           	// 색상 
     boolean power;         	// 전원상태(on/off) 
     int channel;           	// 채널 

     // Tv의 기능(메서드) 
     void power()   { power = !power; }  // TV를 켜거나 끄는 기능을 하는 메서드  
     void channelUp()   {  ++channel; }  // TV의 채널을 높이는 기능을 하는 메서드 
     void channelDown() { --channel; }   // TV의 채널을 낮추는 기능을 하는 메서드  
}

class TvTest { 
      public static void main(String args[]) { 
            Tv t;                  // Tv인스턴스를 참조하기 위한 변수 t를 선언       
            t = new Tv();          // Tv인스턴스를 생성한다. 
            t.channel = 7;         // Tv인스턴스의 멤버변수 channel의 값을 7로 한다. 
            t.channelDown();       // Tv인스턴스의 메서드 channelDown()을 호출한다. 
            System.out.println("현재 채널은 " + t.channel + " 입니다."); 
      } 
}
```
인스턴스는 참조변수를 통해서만 다룰 수 있으며, 참조변수의 타이은 인스턴스의 타입과 일치해야 한다.

# 객체 배열


```java
class TvTest4 {
	public static void main(String args[]) {
		Tv[] tvArr = new Tv[3]; // 길이가 3인 Tv객체 배열

		// Tv객체를 생성해서 Tv객체 배열의 각 요소에 저장
		for(int i=0; i < tvArr.length;i++) {
			tvArr[i] = new Tv();
			tvArr[i].channel = i+10; // tvArr[i]의 channel에 i+10을 저장
		}

		for(int i=0; i < tvArr.length;i++) {
			tvArr[i].channelUp();  // tvArr[i]의 메서드를 호출. 채널이 1증가
			System.out.printf("tvArr[%d].channel=%d%n",i,tvArr[i].channel);
		}
	} // main의 끝
}

class Tv { 
     // Tv의 속성(멤버변수) 
     String color;           // 색상 
     boolean power;          // 전원상태(on/off) 
     int channel;          	 // 채널 

     // Tv의 기능(메서드) 
     void power()   { power = !power; }  // TV를 켜거나 끄는 기능을 하는 메서드 
     void channelUp()   {  ++channel; }  // TV의 채널을 높이는 기능을 하는 메서드 
     void channelDown() {  --channel; }  // TV의 채널을 낮추는 기능을 하는 메서드  
}
```
객체 배열안에 객체가 저장되는 것이 아니라 객체의 주소가 저장된다. 
객체 배열은 참조변수들을 하나로 묶은 참조 변수 배열이다.

# 변수와 메서드

### 선언위치에 따른 변수의 종류

|변수의 종류|선언위치|생성시기|
|-----|-----|-----|
|클래스변수|클래스 영역|클래스가 메모리에 올라갈 때|
|인스턴스 변수|클래스 영역|인스턴스가 생성될때|
|지역변수|클래스 영역 이외의 영역(메서드, 생성자, 초기화 블럭 내부)|변수 선언문이 수행될때|

1. 인스턴스 변수<br>
클래스 영역에 선언되며, 클래스의 인스턴스를 생성할 때 만들어진다. 이 값을 읽어오거나 저장하기 위해 먼저 인스턴스를 생성해야 한다.
인스턴스는 독립적인 공간을 가지고 있어 서로 다른 값을 가질 수 있다.(인스턴스 마다)

2. 클래스 변수<br>
클래스 변수 선언 방법은 인스턴스 변수 앞에 static을 붙이면 된다. 인스턴스마다 독립적인 저장공간을 가지지 않는다. 모든 인스턴스가 공통된 저장공간(변수)을 공유한다.
클래스 변수는 인스턴스를 생성하지 않고도 언제라도 사용가능하다. ' 클래스이름.클래스변수 ' 로 접근이 가능하다.
클래스가 메모리에 로딩될때 생성되어 프로그램이 종료될 때 까지 유지되며 public을 앞에 붙이면 같은 프로그램 내에서 어디서나 접근할 수 있는 전역변수의 성격을 갖는다.

3. 지역변수<br>
메서드 내에 선언되에 메서드 내에서만 사용가능하다. 메서드가 종료되면 소멸되어 사용할 수 없다.

### 메서드

메서드는 특정 작업을 수행하는 일련의 문장들을 하나로 묶은 것이다.

메서드를 사용하는 이유는 높은 재사용성, 중복된 코드 제거, 프로그램의 구조화가 있다.

```java
반환타입 메서드이름 ( 타입변수명, 타입 변수명, ...)
{
   메서드 호출시 수행될 코드
}

int add(int a, int b){
    return a+b;
}

int result = add(1,2); // method 호출
```
메서드를 호출할 때 괄호 안에 지정해준 값들을 인자(argument) 또는 인수라고 한다. 
인자는 메서드가 호출되면서 매개변수에 대입된다. 인자의 타입은 매개변수의 타입과 일치하거나 자동 형변환이 가능한 것이어야 한다.


### 기본형 매개변수와 참조형 매개변수




